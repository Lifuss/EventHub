import{i as j,h as b,a as P,u as N,j as e,L as p,r as u}from"./index-wPLbp_V2.js";import{Q as y,u as R,e as w}from"./service-SwUuEsPz.js";import{B as v,a as E}from"./Button-C3n_JKjS.js";var k=class extends y{constructor(t,s){super(t,s)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t,s){super.setOptions({...t,behavior:j()},s)}getOptimisticResult(t){return t.behavior=j(),super.getOptimisticResult(t)}fetchNextPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"backward"}}})}createResult(t,s){var f,m;const{state:i}=t,a=super.createResult(t,s),{isFetching:l,isRefetching:d,isError:o,isRefetchError:x}=a,n=(m=(f=i.fetchMeta)==null?void 0:f.fetchMore)==null?void 0:m.direction,h=o&&n==="forward",r=l&&n==="forward",c=o&&n==="backward",g=l&&n==="backward";return{...a,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:b(s,i.data),hasPreviousPage:P(s,i.data),isFetchNextPageError:h,isFetchingNextPage:r,isFetchPreviousPageError:c,isFetchingPreviousPage:g,isRefetchError:x&&!h&&!c,isRefetching:d&&!r&&!g}}};function O(t,s){return R(t,k)}const C=({event:t})=>{const s=N(),{title:i,description:a,organizer:l,eventDate:d,_id:o}=t;return e.jsxs("li",{className:"border border-terracotta shadow-sm rounded-lg px-2 py-4 xl:px-4 text-sm h-[350px] flex flex-col bg-beige",children:[e.jsx("h2",{className:"font-medium mb-2 text-xl",children:i}),e.jsx("p",{children:a}),e.jsxs("div",{className:"mt-auto mb-1",children:[e.jsx("p",{children:"Organizer"}),e.jsx("p",{className:"font-medium",children:l})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{children:"Date"}),e.jsx("p",{className:"font-medium",children:new Date(d).toLocaleDateString("uk-UA")})]}),e.jsxs("div",{className:"flex justify-between ",children:[e.jsx(p,{className:v,state:{from:s},to:`/register/${o.toString()}`,children:"Register"}),e.jsx(p,{className:v,state:{from:s},to:`/${o.toString()}`,children:"View"})]})]})},M=({sort:t,setSort:s,order:i,setOrder:a})=>e.jsxs("div",{className:"flex justify-center mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{children:"Sort By:"}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"sort",value:"title",checked:t==="title",onChange:()=>s("title")}),"Title"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"sort",value:"organizer",checked:t==="organizer",onChange:()=>s("organizer")}),"Organizer"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"sort",value:"date",checked:t==="date",onChange:()=>s("date")}),"Date"]})]}),e.jsxs("div",{className:"flex flex-col ml-4",children:[e.jsx("h2",{children:"Order:"}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"order",value:"asc",checked:i==="asc",onChange:()=>a("asc")}),"Ascending"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"order",value:"desc",checked:i==="desc",onChange:()=>a("desc")}),"Descending"]})]})]}),z=()=>{const t=u.useRef(null),[s,i]=u.useState("title"),[a,l]=u.useState("asc"),{data:d,isLoading:o,isError:x,fetchNextPage:n,hasNextPage:h}=O({queryKey:["events",s,a],queryFn:({pageParam:r=1})=>w.getEvents(r,s,a),getNextPageParam:(r,c)=>r.hasMore?c.length+1:void 0,select:r=>r.pages.flatMap(c=>c.events)});return u.useEffect(()=>{const r=new IntersectionObserver(c=>{c[0].isIntersecting&&h&&n()});return t.current&&r.observe(t.current),()=>{t.current&&r.unobserve(t.current)}},[h,n]),x?e.jsxs("div",{className:"h-[400px] text-2xl grid place-items-center",children:[e.jsx("h1",{children:"Ocurred error while fetching data"}),e.jsx(E,{onClick:()=>n(),children:"Try again"})]}):o?e.jsx("div",{children:e.jsx("h1",{className:"text-2xl grid place-items-center h-[400px]",children:"Loading..."})}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-4xl mb-4 md:mb-6 text-center text-terracotta",children:"EventHub"}),e.jsx(M,{order:a,setOrder:l,sort:s,setSort:i}),e.jsx("ul",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 xl:gap-10",children:d.length?d.map(r=>e.jsx(C,{event:r},r._id)):e.jsx("div",{children:" Not found 😶‍🌫️"})}),e.jsx("div",{ref:t,className:"h-10"})]})};export{z as default};
